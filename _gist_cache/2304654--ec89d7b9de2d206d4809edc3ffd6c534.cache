describe 'StateCharts', ->
  describe 'rootState', ->
    it 'should transition to parsing state', ->
      spyOn(Lead.parsing_controller, 'start_parsing')

      state_manager = Lead.StateManager.create()

      Ember.run ->
        state_manager.send('startParsing', {search_url: "http://thesoftwaresimpleton.com/"})

      expect(Lead.get('parsing_controller').get('isParsing')).toBeTruthy()
      expect(Lead.get('parsing_controller').start_parsing).toHaveBeenCalled()